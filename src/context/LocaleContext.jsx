import React, { createContext, useContext, useEffect, useMemo, useState } from "react";

const translations = {
  en: {
    "header.greeting": "Good Morning, Ahmed",
    "menu.main": "MENU",
    "menu.general": "GENERAL",
    "nav.dashboard": "Dashboard",
    "nav.diagnosisModule": "Diagnosis Module",
    "nav.diagnosis": "Diagnosis",
    "nav.aiDiagnosisResult": "AI Diagnosis Result",
    "nav.drugChecker": "Drug Checker",
    "nav.physiotherapy": "Physiotherapy",
    "nav.inquiries": "Inquiries",
    "nav.consultations": "Consultations",
    "nav.myPatients": "My patients",
    "nav.medicalFiles": "Medical Files",
    "nav.payment": "Payment",
    "nav.treatment": "Treatment",
    "nav.reports": "Reports",
    "nav.finances": "Finances",
    "nav.appointments": "Appointments",
    "nav.directory": "Directory",
    "nav.complaints": "Complaints",
    "nav.settings": "Settings",
    "nav.help": "Help",
    "nav.logout": "Logout",
    "settings.title": "Settings",
    "settings.subtitle": "Manage your account preferences",
    "settings.profile.title": "Profile Settings",
    "settings.profile.description": "Update your name, email, and profile details",
    "settings.profile.button": "Edit Profile",
    "settings.security.title": "Security",
    "settings.security.passwordTitle": "Password",
    "settings.security.passwordDesc": "Change your account password",
    "settings.security.passwordButton": "Change Password",
    "settings.security.2faTitle": "Two-Factor Authentication",
    "settings.security.2faDesc": "Add an extra layer of security to your account",
    "settings.notifications.title": "Notifications",
    "settings.notifications.emailTitle": "Email Notifications",
    "settings.notifications.emailDesc": "Receive notifications via email",
    "settings.notifications.smsTitle": "SMS Notifications",
    "settings.notifications.smsDesc": "Receive notifications via SMS",
    "settings.general.title": "General",
    "settings.general.language": "Language",
    "settings.general.languageDesc": "Choose your language",
    "settings.general.english": "English",
    "settings.general.arabic": "Arabic",
    "modal.profile.title": "Edit Profile",
    "modal.profile.name": "Full Name",
    "modal.profile.email": "Email Address",
    "modal.profile.phone": "Phone Number",
    "modal.profile.save": "Save Changes",
    "modal.password.title": "Change Password",
    "modal.password.current": "Current Password",
    "modal.password.new": "New Password",
    "modal.password.confirm": "Confirm New Password",
    "modal.password.save": "Change Password",
    "modal.cancel": "Cancel",
    "directory.title": "Hospitals & Doctors Directory",
    "directory.subtitle": "Search specialists and hospitals and refine the list using the quick filters.",
    "directory.filters": "Filters:",
    "directory.reset": "Reset Filters",
    "directory.filter.location": "Location",
    "directory.filter.experience": "Experience",
    "directory.filter.availability": "Availability",
    "directory.filter.rate": "Rate",
    "directory.doctor.experience": "15 years experience",
    "directory.doctor.nextAvailable": "Next Available: Fri, 6:00 PM",
    "directory.confirm": "Confirm",
    "payment.title": "Payment",
    "payment.viewHistory": "View History",
    "payment.type.consultation": "Paid for Consultation",
    "payment.type.prescription": "Paid for Prescription",
    "payment.enterDetails": "Enter Details",
    "payment.cardholder": "Cardholder's name",
    "payment.cardNumber": "Card Number",
    "payment.expiry": "Expiration date",
    "payment.cvv": "CVV/CVC",
    "payment.method.title": "Choose Payment Method",
    "payment.method.card": "Credit Card",
    "payment.method.wallet": "Mobile Wallet",
    "payment.method.bank": "Bank Transfer",
    "payment.confirm": "Confirm",
    "diagnosis.title": "AI Diagnosis Results",
    "diagnosis.subtitle":
      "This is a preliminary diagnosis provided by our AI model. Please consult with a healthcare professional for confirmation and personalized recommendations.",
    "diagnosis.name": "Diagnosis Name",
    "diagnosis.confidence": "Confidence Level",
    "diagnosis.description.title": "Condition Description",
    "diagnosis.followup.title": "Follow Up Questions",
    "diagnosis.selectDoctor": "Select Doctor",
    "diagnosis.goToTreatment": "Go To Treatment",
    "diagnosis.module.title": "Diagnosis Module",
    "diagnosis.module.subtitle": "Upload medical files or enter symptoms for AI analysis.",
    "diagnosis.module.upload.title": "Upload your files here",
    "diagnosis.module.upload.subtitle": "Drag and drop your files here, or click to browse",
    "diagnosis.module.upload.image": "Upload image",
    "diagnosis.module.upload.file": "Upload file",
    "diagnosis.module.upload.formats": "Supported formats: PDF, JPG, PNG, ZIP",
    "diagnosis.module.upload.max": "Maximum size: 10 MB",
    "diagnosis.module.manual.title": "Manual Symptoms Entry",
    "diagnosis.module.manual.subtitle":
      "Please enter all information about your symptoms to receive accurate diagnosis.",
    "diagnosis.module.manual.symptoms": "Add your symptoms",
    "diagnosis.module.manual.case": "Describe your case",
    "diagnosis.module.manual.analyze": "Analyze",
    "diagnosis.module.uploading.title": "Uploading",
    "diagnosis.module.uploading.failed": "1 item failed to upload",
    "diagnosis.module.uploading.retry": "Try again",
    "diagnosis.module.uploading.inProgress": "Uploading",
    "diagnosis.module.symptomsModal.title": "Add Symptoms",
    "diagnosis.module.symptomsModal.subtitle":
      "Select from the list or add a custom symptom.",
    "diagnosis.module.symptomsModal.placeholder": "Enter your Symptom",
    "diagnosis.module.symptomsModal.common": "Common Symptoms",
    "diagnosis.module.symptomsModal.add": "Add Selected Symptom",
    "diagnosis.module.symptomsModal.cancel": "Cancel",
    "diagnosis.module.caseModal.title": "Describe Your Case",
    "diagnosis.module.caseModal.subtitle":
      "Provide a detailed description of symptoms and relevant medical history.",
    "diagnosis.module.caseModal.placeholder": "Describe your case",
    "diagnosis.module.caseModal.of": "of",
    "diagnosis.module.caseModal.save": "Save",
    "diagnosis.module.caseModal.cancel": "Cancel",
    "diagnosis.module.help.title": "Help & Support",
    "diagnosis.module.help.searchPlaceholder": "Search FAQs...",
    "diagnosis.module.help.show": "Show",
    "diagnosis.module.help.hide": "Hide",
    "diagnosis.module.help.noResults": "No matching questions.",
    "diagnosis.module.help.contactTitle": "Contact Support",
    "diagnosis.module.help.contactSubtitle":
      "Send us a ticket or start a live chat",
    "diagnosis.module.help.contactButton": "Submit Ticket",
    "diagnosis.module.help.faq1.q": "How do I start a physiotherapy session?",
    "diagnosis.module.help.faq1.a":
      "Go to the physiotherapy section and choose a plan to begin.",
    "diagnosis.module.help.faq2.q": "How do I send a question to the doctor?",
    "diagnosis.module.help.faq2.a":
      "Open the doctor directory and send a message from their profile.",
    "diagnosis.module.help.faq3.q": "How do I upload a medical file?",
    "diagnosis.module.help.faq3.a":
      "Use the upload area above to add PDFs, images, or ZIP files.",
    "help.page.title": "Help & Support",
    "help.page.searchPlaceholder": "Search FAQs...",
    "help.page.show": "Show",
    "help.page.hide": "Hide",
    "help.page.noResults": "No matching questions.",
    "help.page.contactTitle": "Contact Support",
    "help.page.contactSubtitle": "Send us a ticket or start a live chat",
    "help.page.contactButton": "Submit Ticket",
    "help.page.faq1.q": "How do I start a physiotherapy session?",
    "help.page.faq1.a": "Go to the physiotherapy section and choose a plan to begin.",
    "help.page.faq2.q": "How do I send a question to the doctor?",
    "help.page.faq2.a": "Open the doctor directory and send a message from their profile.",
    "help.page.faq3.q": "How do I upload a medical file?",
    "help.page.faq3.a": "Use the upload area to add PDFs, images, or ZIP files.",
  },
  ar: {
    "header.greeting": "صباح الخير، أحمد",
    "menu.main": "القائمة",
    "menu.general": "عام",
    "nav.dashboard": "لوحة التحكم",
    "nav.diagnosisModule": "وحدة التشخيص",
    "nav.diagnosis": "التشخيص",
    "nav.aiDiagnosisResult": "نتيجة التشخيص بالذكاء الاصطناعي",
    "nav.drugChecker": "مدقق الأدوية",
    "nav.physiotherapy": "العلاج الطبيعي",
    "nav.inquiries": "الاستفسارات",
    "nav.consultations": "الاستشارات",
    "nav.myPatients": "مرضاي",
    "nav.medicalFiles": "الملفات الطبية",
    "nav.payment": "الدفع",
    "nav.treatment": "العلاج",
    "nav.reports": "التقارير",
    "nav.finances": "المالية",
    "nav.appointments": "المواعيد",
    "nav.directory": "الدليل",
    "nav.complaints": "الشكاوى",
    "nav.settings": "الإعدادات",
    "nav.help": "مساعدة",
    "nav.logout": "تسجيل الخروج",
    "settings.title": "الإعدادات",
    "settings.subtitle": "إدارة تفضيلات حسابك",
    "settings.profile.title": "إعدادات الملف الشخصي",
    "settings.profile.description": "تحديث الاسم والبريد الإلكتروني وتفاصيل الملف",
    "settings.profile.button": "تعديل الملف",
    "settings.security.title": "الأمان",
    "settings.security.passwordTitle": "كلمة المرور",
    "settings.security.passwordDesc": "تغيير كلمة مرور الحساب",
    "settings.security.passwordButton": "تغيير كلمة المرور",
    "settings.security.2faTitle": "المصادقة الثنائية",
    "settings.security.2faDesc": "أضف طبقة أمان إضافية لحسابك",
    "settings.notifications.title": "الإشعارات",
    "settings.notifications.emailTitle": "إشعارات البريد الإلكتروني",
    "settings.notifications.emailDesc": "استقبال الإشعارات عبر البريد",
    "settings.notifications.smsTitle": "إشعارات الرسائل النصية",
    "settings.notifications.smsDesc": "استقبال الإشعارات عبر الرسائل",
    "settings.general.title": "عام",
    "settings.general.language": "اللغة",
    "settings.general.languageDesc": "اختر لغتك",
    "settings.general.english": "الإنجليزية",
    "settings.general.arabic": "العربية",
    "modal.profile.title": "تعديل الملف الشخصي",
    "modal.profile.name": "الاسم الكامل",
    "modal.profile.email": "البريد الإلكتروني",
    "modal.profile.phone": "رقم الهاتف",
    "modal.profile.save": "حفظ التغييرات",
    "modal.password.title": "تغيير كلمة المرور",
    "modal.password.current": "كلمة المرور الحالية",
    "modal.password.new": "كلمة المرور الجديدة",
    "modal.password.confirm": "تأكيد كلمة المرور الجديدة",
    "modal.password.save": "تغيير كلمة المرور",
    "modal.cancel": "إلغاء",
    "directory.title": "دليل المستشفيات والأطباء",
    "directory.subtitle": "ابحث عن الأطباء والمستشفيات وحدد النتائج باستخدام المرشحات السريعة.",
    "directory.filters": "المرشحات:",
    "directory.reset": "إعادة التعيين",
    "directory.filter.location": "الموقع",
    "directory.filter.experience": "الخبرة",
    "directory.filter.availability": "التوفر",
    "directory.filter.rate": "التقييم",
    "directory.doctor.experience": "15 سنة خبرة",
    "directory.doctor.nextAvailable": "أقرب موعد: الجمعة، 6:00 م",
    "directory.confirm": "تأكيد",
    "payment.title": "الدفع",
    "payment.viewHistory": "عرض السجل",
    "payment.type.consultation": "دفع للاستشارة",
    "payment.type.prescription": "دفع للوصفة",
    "payment.enterDetails": "إدخال البيانات",
    "payment.cardholder": "اسم صاحب البطاقة",
    "payment.cardNumber": "رقم البطاقة",
    "payment.expiry": "تاريخ الانتهاء",
    "payment.cvv": "CVV/CVC",
    "payment.method.title": "اختر طريقة الدفع",
    "payment.method.card": "بطاقة ائتمان",
    "payment.method.wallet": "محفظة إلكترونية",
    "payment.method.bank": "تحويل بنكي",
    "payment.confirm": "تأكيد",
    "diagnosis.title": "نتائج التشخيص بالذكاء الاصطناعي",
    "diagnosis.subtitle":
      "هذا تشخيص مبدئي من نموذج الذكاء الاصطناعي. يرجى استشارة مختص للتأكيد والحصول على توصيات مخصصة.",
    "diagnosis.name": "اسم التشخيص",
    "diagnosis.confidence": "مستوى الثقة",
    "diagnosis.description.title": "وصف الحالة",
    "diagnosis.followup.title": "أسئلة المتابعة",
    "diagnosis.selectDoctor": "اختر طبيبًا",
    "diagnosis.goToTreatment": "اذهب للعلاج",
  },
};

const LocaleContext = createContext({
  language: "en",
  setLanguage: () => {},
  t: (key) => key,
});

export function LocaleProvider({ children }) {
  const [language, setLanguage] = useState(() => {
    if (typeof window !== "undefined") {
      return localStorage.getItem("appLanguage") || "en";
    }
    return "en";
  });

  useEffect(() => {
    if (typeof window !== "undefined") {
      localStorage.setItem("appLanguage", language);
      document.documentElement.lang = language;
      document.documentElement.dir = language === "ar" ? "rtl" : "ltr";
    }
  }, [language]);

  const t = useMemo(() => {
    return (key) => translations[language]?.[key] || translations.en[key] || key;
  }, [language]);

  const value = useMemo(
    () => ({
      language,
      setLanguage,
      t,
    }),
    [language, t]
  );

  return <LocaleContext.Provider value={value}>{children}</LocaleContext.Provider>;
}

export function useLocale() {
  return useContext(LocaleContext);
}
